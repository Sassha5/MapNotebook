<?xml version="1.0" encoding="UTF-8"?>
<views:BaseContentPage xmlns="http://xamarin.com/schemas/2014/forms"
                       xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
                       xmlns:prism="http://prismlibrary.com"
                       prism:ViewModelLocator.AutowireViewModel="True"
                       xmlns:views="clr-namespace:MapNotepad.Views"
                       xmlns:controls="clr-namespace:MapNotepad.Controls"
                       x:Class="MapNotepad.Views.MapPage"
                       x:Name="mapPage"
                       Title="{Binding Resources[Map]}">

    <Grid HorizontalOptions="FillAndExpand"
              VerticalOptions="FillAndExpand">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <controls:CustomMap x:Name="map"
                                VerticalOptions="FillAndExpand"
                                MyLocationEnabled="True"
                                SelectedPin="{Binding SelectedPin, Mode=TwoWay}"
                                HasZoomEnabled="True"
                                PinsCollection="{Binding PinCollection}"
                                MapCameraPosition="{Binding CameraPosition}"
                                PinClicked="PinClicked"
                                MapClicked="MapClicked">
        </controls:CustomMap>
        <Frame x:Name="pinInfo"
                   VerticalOptions="End">
            <StackLayout>
                <Label Style="{StaticResource MediumLabelStyle}"
                                       VerticalOptions="Center">
                    <Label.FormattedText>
                        <FormattedString>
                            <Span Text="Label: "/>
                            <Span Text="{Binding SelectedPin.Label}"/>
                        </FormattedString>
                    </Label.FormattedText>
                </Label>
                <Label Style="{StaticResource SmallLabelStyle}">
                    <Label.FormattedText>
                        <FormattedString>
                            <Span Text="Latitude: "/>
                            <Span Text="{Binding SelectedPin.Position.Latitude}"/>
                        </FormattedString>
                    </Label.FormattedText>
                </Label>
                <Label Style="{StaticResource SmallLabelStyle}">
                    <Label.FormattedText>
                        <FormattedString>
                            <Span Text="Longitude: "/>
                            <Span Text="{Binding SelectedPin.Position.Longitude}"/>
                        </FormattedString>
                    </Label.FormattedText>
                </Label>
                <Label Style="{StaticResource SmallLabelStyle}">
                    <Label.FormattedText>
                        <FormattedString>
                            <Span Text="Description: "/>
                            <Span Text="{Binding Description}"/>
                        </FormattedString>
                    </Label.FormattedText>
                </Label>
            </StackLayout>
        </Frame>
        <SearchBar VerticalOptions="StartAndExpand"
                       Grid.Row="0"
                       Placeholder="{Binding Resources[Search]}"
                       Text="{Binding SearchBarText}"
                       SearchCommand="{Binding SearchCommand}"
                       x:Name="searchBar"
                       Style="{StaticResource SearchBarStyle}">
            <SearchBar.Behaviors>
                <prism:EventToCommandBehavior EventName="TextChanged"
                                                      Command="{Binding SearchCommand}"/>
            </SearchBar.Behaviors>
        </SearchBar>
    </Grid>
</views:BaseContentPage>
